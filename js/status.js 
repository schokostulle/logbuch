// /logbuch/js/status.js — Version 0.3 (zentraler Statuscontroller)
/**
 * Globale Statusmeldungen für das Logbuch
 * ----------------------------------------
 * Funktionen:
 *   status.show(message, type?, duration?)
 *   status.clear()
 * ----------------------------------------
 * type: "info" | "ok" | "warn" | "error"
 * duration: ms bis zum automatischen Ausblenden (0 = dauerhaft)
 */

const status = (() => {
  let el;
  let timeoutId;

  function init() {
    el = document.getElementById("status-bar");
    if (!el) {
      el = document.createElement("div");
      el.id = "status-bar";
      el.className = "status hidden";
      document.body.appendChild(el);
    }
  }

  function show(message, type = "info", duration = 2500) {
    if (!el) init();

    // Vorherige Ausblendung abbrechen
    if (timeoutId) clearTimeout(timeoutId);

    el.textContent = message;
    el.className = `status ${type}`;
    el.classList.remove("hidden");
    el.classList.add("show");

    if (duration > 0) {
      timeoutId = setTimeout(() => clear(), duration);
    }
  }

  function clear() {
    if (!el) return;
    el.classList.remove("show");
    setTimeout(() => {
      el.classList.add("hidden");
      el.textContent = "";
    }, 300);
  }

  return { show, clear };
})();